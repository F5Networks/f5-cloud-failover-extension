{
    "$id": "base_schema.json",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Cloud Failover",
    "description": "Top level schema for enabling cloud failover for BIG-IP",
    "type": "object",
    "definitions": {},
    "required": [
        "class",
        "environment"
    ],
    "properties": {
        "class": {
            "title": "Class",
            "description": "Cloud failover top level class",
            "type": "string",
            "enum": ["Cloud_Failover"]
        },
        "schemaVersion": {
            "title": "Schema version",
            "description": "Version of ADC Declaration schema this declaration uses",
            "type": "string",
            "$comment": "IMPORTANT: In enum array, please put current schema version first, oldest-supported version last.  Keep enum array sorted most-recent-first.",
            "enum": ["0.9.0"],
            "default": "0.9.0"
        },
        "$schema": {
            "title": "Schema",
            "description": "URL of schema against which to validate. Used by validation in your local environment only (via Visual Studio Code, for example)",
            "type": "string"
        },
        "environment": {
            "title": "Environment",
            "description": "Cloud provider environment.",
            "type": "string",
            "enum": ["gce", "aws", "azure"]
        },
        "addressTags": {
            "title": "Address tags",
            "description": "Unique tag(s) for identifying network interfaces and elastic IPs to be managed.",
            "type": "array",
            "items": [
                {
                    "key": {"type":"string"}
                },
                {
                    "value": {"type":"string"}
                }
            ]
        },
        "managedRoutes": {
            "title": "Routes",
            "description": "Route(s) this deployment will manage.",
            "type": "array",
            "items": {
                "type": "string",
                "pattern": "^([0-9]{1,3}\\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$"
            }
        },
        "storageResource": {
            "title": "Storage resource name",
            "description": "The name of the provider resource (Azure storage account, S3 bucket) to use for config and state storage.",
            "type": "string"
        },
        "storageTags": {
            "title": "Storage tags",
            "description": "Unique tag(s) for identifying network interfaces or elastic IPs to be managed.",
            "type": "array",
            "items": [
                {
                    "key": {"type":"string"}
                },
                {
                    "value": {"type":"string"}
                }
            ]
        },
        "useMetadata": {
            "title": "Metdata override",
            "description": "Option to override gathering info from provider metadata.",
            "type": "boolean",
            "default": true
        }
    },
    "allOf": [
        {
            "if": { "properties": { "environment": { "const": "azure" } } },
            "then": {
                "if": { "properties": { "useMetadata": { "const": false } } },
                "then": {
                    "required": ["subscription", "resourceGroupName", "location"],
                    "subscription": {
                        "title": "Subscription ID",
                        "description": "Azure subscription ID.",
                        "type": "string"
                    },
                    "resourceGroupName": {
                        "title": "Resource group",
                        "description": "Azure resource group name.",
                        "type": "string"
                    },
                    "location": {
                        "title": "Location",
                        "description": "Azure deployment location.",
                        "type": "string",
                        "enum": ["eastasia","southeastasia","centralus","eastus","eastus2","westus","northcentralus","southcentralus","northeurope","westeurope","japanwest","japaneast","brazilsouth","australiaeast","australiasoutheast","southindia","centralindia","westindia","canadacentral","canadaeast","uksouth","ukwest","westcentralus","westus2","koreacentral","koreasouth","francecentral","francesouth","australiacentral","australiacentral2","southafricanorth","southafricawest","usdodcentral","usdodeast","usgovarizona","usgoviowa","usgovtexas","usgovvirginia","ussecwest","usseceast"]
                    }
                }
            }
        },
        {
            "if": { "properties": { "environment": { "const": "aws" } } },
            "then": {}
        },
        {
            "if": { "properties": { "environment": { "const": "gce" } } },
            "then": {
                "then": {}
            }
        }
    ],
    "additionalProperties": false
}