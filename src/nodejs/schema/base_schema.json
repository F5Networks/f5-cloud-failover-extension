{
    "$id": "base_schema.json",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Cloud Failover",
    "description": "Top level schema for enabling cloud failover for BIG-IP",
    "type": "object",
    "definitions": {},
    "required": [
        "class",
        "environment"
    ],
    "properties": {
        "class": {
            "title": "Class",
            "description": "Cloud failover top level class",
            "type": "string",
            "enum": ["Cloud_Failover"]
        },
        "schemaVersion": {
            "title": "Schema version",
            "description": "Version of ADC Declaration schema this declaration uses",
            "type": "string",
            "$comment": "IMPORTANT: In enum array, please put current schema version first, oldest-supported version last.  Keep enum array sorted most-recent-first.",
            "enum": ["0.9.1", "0.9.0"],
            "default": "0.9.0"
        },
        "$schema": {
            "title": "Schema",
            "description": "URL of schema against which to validate. Used by validation in your local environment only (via Visual Studio Code, for example)",
            "type": "string"
        },
        "environment": {
            "title": "Environment",
            "description": "Cloud provider environment.",
            "type": "string",
            "enum": ["aws", "azure", "gcp"]
        },
        "failoverAddresses": {
            "title": "Failover Addresses",
            "description": "Addresses this deployment will manage.",
            "type": "object",
            "properties": {
                "scopingTags": {
                    "type": "object",
                    "additionalProperties": true
                }
            }
        },
        "failoverRoutes": {
            "title": "Failover Routes",
            "description": "Route(s) this deployment will manage.",
            "type": "object",
            "properties": {
                "scopingTags": {
                    "type": "object",
                    "additionalProperties": true
                },
                "scopingAddressRanges": {
                    "type": "array",
                    "pattern": "^([0-9]{1,3}\\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$"
                }
            }
        },
        "externalStorage": {
            "title": "External Storage",
            "description": "External storage this deployment will manage.",
            "type": "object",
            "properties": {
                "scopingTags": {
                    "type": "object",
                    "additionalProperties": true
                }
            }
        }
    },
    "allOf": [
        {
            "if": { "properties": { "environment": { "const": "azure" } } },
            "then": {}
        },
        {
            "if": { "properties": { "environment": { "const": "aws" } } },
            "then": {}
        },
        {
            "if": { "properties": { "environment": { "const": "gcp" } } },
            "then": {
                "then": {}
            }
        }
    ],
    "additionalProperties": false
}
